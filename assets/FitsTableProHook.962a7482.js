import{Y as P,z as C,ak as l,al as w}from"./clientConfigs.5694047d.js";import{S as A,D as T,e as E}from"./index.a0f7981d.js";function D(a,o){return a.then(u=>[null,u]).catch(u=>o?[Object.assign({},u,o),void 0]:[u,void 0])}const k=()=>({print:(u,e,i="primary")=>{},log:{primary:(u,e)=>{},success:(u,e)=>{},info:(u,e)=>{},warning:(u,e)=>{},danger:(u,e)=>{}}}),R=a=>{var e,i;const o=P(a.store),{log:u}=k();if(a.enabled){const s=new A({name:(e=a.dataBase)!=null?e:"FitsAdmin",storeName:(i=a.dataSheet)!=null?i:"UserHabits",driverOrder:[T.IndexedDB,T.LocalStorage]});(async()=>{var g;await s.create();const[m,f]=await D(s.get(a.key));if(m)throw new Error(`\u83B7\u53D6\u6570\u636E\u5931\u8D25, \u5931\u8D25\u539F\u56E0\uFF1A${m}`);const y=(g=l.toStringJSON(f))!=null?g:null;y!==null&&l.merge(o,y)})(),C(()=>o,async m=>{const[f]=await D(s.set(a.key,l.toJSONString(m)));if(f)throw new Error(`\u4FDD\u5B58\u6570\u636E\u5931\u8D25, \u5931\u8D25\u539F\u56E0\uFF1A${f}`);u.success("FitsTable\u7EC4\u4EF6\u6570\u636E\u53D8\u5316",m)},{deep:!0})}return{store:o}},O=(a,o)=>{var g;const u={id:(g=a.id)!=null?g:"FitsTable",keepSource:!1,rowConfig:{height:40},exportConfig:{},storage:{enabled:!1,key:"",dataBase:"",dataSheet:"FitsTableComponent"},formConfig:l.isPlainObject(a.formConfig)?{items:[],titleAlign:"right",titleWidth:"100px",titleOverflow:!0}:null,pagerConfig:l.isPlainObject(a.pagerConfig)?{layouts:["Total","Sizes","PrevJump","PrevPage","Number","NextPage","NextJump","FullJump"],pageSizes:[10,15,20,50,100],background:!0}:{enabled:!1},columns:[],toolbarConfig:{zoom:!1,export:!1,custom:!1}},e=l.merge(u,a),i=[],{store:s}=R({...e.storage,store:{isShowSearchForm:!0,customQueryArray:[],customColumnArray:[]}});m(),f();const d=P(e);function m(){var c;const n={search:{toolRender:{name:"FitsToolbarSearch",events:{click:()=>{s.isShowSearchForm=!s.isShowSearchForm}}}},query:{toolRender:{name:"FitsToolbarSetting",events:{get:()=>s.customQueryArray,setCustomQuerySelected:r=>{var h,p;const b=(h=o.value)==null?void 0:h.fitsTablePro.getProxyInfo();l.merge(b==null?void 0:b.form,r.form),(p=o.value)==null||p.fitsTablePro.commitProxy("query")},setCustomQueryData:r=>{s.customQueryArray=[...r]},changFromItemStatus:r=>{var h,p,S,F;((p=(h=o.value)==null?void 0:h.fitsTablePro.props.formConfig)==null?void 0:p.items).find(v=>v.field===r.field&&(v.visible=r.visible)),(F=o.value)==null||F.handleFormItemNumber((S=o.value)==null?void 0:S.$el.clientWidth)}}}},refresh:{toolRender:{name:"FitsToolbarRefresh",events:{click:()=>{var r;(r=o.value)==null||r.fitsTablePro.commitProxy("query")}}}},export:{toolRender:{name:"FitsToolbarExport",events:{click:()=>{var r;(r=o.value)==null||r.fitsTablePro.openExport()}}}},fullscreen:{toolRender:{name:"FitsToolbarFullscreen",props:{isShowSearchForm:s.isShowSearchForm},events:{get:()=>s.isShowSearchForm}}},custom:{toolRender:{name:"FitsToolbarCustomColumn",events:{geCustomColumnData:()=>l.clone(s.customColumnArray,!0),setCustomColumnData:r=>{s.customColumnArray=l.clone(r,!0)}}}}},t=(c=e.toolbarConfig)==null?void 0:c.tools;l.isPlainObject(t)&&(t.enabled!==!1&&((t==null?void 0:t.search)!==!1&&(e==null?void 0:e.formConfig)&&i.push(n.search),(t==null?void 0:t.query)!==!1&&(e==null?void 0:e.formConfig)&&i.push(n.query),(t==null?void 0:t.refresh)!==!1&&(e==null?void 0:e.proxyConfig)&&i.push(n.refresh),(t==null?void 0:t.export)!==!1&&i.push(n.export),(t==null?void 0:t.fullscreen)!==!1&&i.push(n.fullscreen),(t==null?void 0:t.custom)!==!1&&i.push(n.custom)),e.toolbarConfig.tools=i)}function f(){var n,t,c;if((n=e.formConfig)!=null&&n.items.length){const r={align:"center",className:"searchBtns",collapseNode:!0,itemRender:{name:"$buttons",children:[{props:{type:"submit",content:"\u641C\u7D22",icon:"vxe-icon-search",status:"primary"}},{props:{type:"reset",content:"\u91CD\u7F6E",icon:"vxe-icon-repeat"}}]}};(c=(t=e.formConfig)==null?void 0:t.items)==null||c.push(r)}}C(()=>s.isShowSearchForm,n=>{w(()=>{var c;const t=o.value.fitsTablePro.$el;t.querySelector(".vxe-grid--form-wrapper").style.display=n?"block":"none",E.emit("IsShowSearchForm",n),document.body.querySelector(".is--maximize")&&((c=o.value)==null||c.fitsTablePro.reloadColumn(d.columns))})});const y=C(()=>s.customColumnArray,()=>{w(()=>{var n;(n=o.value)==null||n.fitsTablePro.reloadColumn(s.customColumnArray),y()})},{deep:!0});return{fitsTablePro:d}};export{k as a,O as u};
